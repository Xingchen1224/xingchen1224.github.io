{% include_cached seo.html %}

<!-- Analytics -->
{% if site.analytics.plausible.domain %}
  <script defer data-domain="{{ site.analytics.plausible.domain }}" src="https://plausible.io/js/plausible.js"></script>
{% endif %}

<!-- Font Preconnect for Performance -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

<!-- Custom CSS -->
<style>
  /* Professional styling overrides */
  .masthead {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  }
  
  .page__title {
    color: #2c3e50;
  }
  
  .author__avatar img {
    border: 3px solid #3498db;
  }
  
  .btn--primary {
    background-color: #3498db;
    border-color: #3498db;
  }
  
  .btn--primary:hover {
    background-color: #2980b9;
    border-color: #2980b9;
  }
  
  /* Project grid styling */
  .grid__item {
    transition: transform 0.3s ease;
  }
  
  .grid__item:hover {
    transform: translateY(-5px);
  }
  
  /* Table of contents styling */
  .toc {
    background-color: #f8f9fa;
    border: 1px solid #e9ecef;
    border-radius: 8px;
  }
  
  .toc__title {
    color: #495057;
    font-weight: 600;
  }

  /* Code block enhancements */
  .highlight {
    position: relative;
  }

  .copy-button {
    position: absolute;
    top: 8px;
    right: 8px;
    background: rgba(255, 255, 255, 0.8);
    border: 1px solid #ddd;
    border-radius: 4px;
    padding: 4px 8px;
    font-size: 12px;
    cursor: pointer;
    transition: all 0.2s ease;
    opacity: 0;
  }

  .highlight:hover .copy-button {
    opacity: 1;
  }

  .copy-button:hover {
    background: rgba(255, 255, 255, 0.95);
    border-color: #3498db;
  }

  .copy-button.copied {
    background: #27ae60;
    color: white;
    border-color: #27ae60;
  }

  /* Dark mode support */
  @media (prefers-color-scheme: dark) {
    .copy-button {
      background: rgba(40, 44, 52, 0.9);
      color: #abb2bf;
      border-color: #4b5263;
    }

    .copy-button:hover {
      background: rgba(40, 44, 52, 1);
      border-color: #3498db;
    }
  }

  /* Skip to content link */
  .skip-link {
    position: absolute;
    top: -40px;
    left: 6px;
    background: #3498db;
    color: white;
    padding: 8px;
    text-decoration: none;
    border-radius: 4px;
    z-index: 9999;
    transition: top 0.3s;
  }

  .skip-link:focus {
    top: 6px;
  }

  /* Enhanced focus states */
  a:focus,
  button:focus,
  input:focus,
  textarea:focus,
  select:focus {
    outline: 2px solid #3498db;
    outline-offset: 2px;
  }

  /* Project technology tags */
  .project-tech {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin: 1rem 0;
  }

  .tech-tag {
    background: #ecf0f1;
    color: #2c3e50;
    padding: 0.25rem 0.5rem;
    border-radius: 16px;
    font-size: 0.8rem;
    font-weight: 500;
  }

  /* Responsive image enhancements */
  img {
    height: auto;
    max-width: 100%;
  }

  /* Performance loading placeholder */
  .loading-placeholder {
    background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
    background-size: 200% 100%;
    animation: loading 1.5s infinite;
  }

  @keyframes loading {
    0% { background-position: 200% 0; }
    100% { background-position: -200% 0; }
  }
</style>

<!-- Code Copy Functionality -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  // Add copy buttons to code blocks
  const codeBlocks = document.querySelectorAll('.highlight');
  
  codeBlocks.forEach(function(block) {
    const button = document.createElement('button');
    button.className = 'copy-button';
    button.textContent = 'Copy';
    button.setAttribute('aria-label', 'Copy code to clipboard');
    
    button.addEventListener('click', function() {
      const code = block.querySelector('code');
      if (code) {
        navigator.clipboard.writeText(code.textContent).then(function() {
          button.textContent = 'Copied!';
          button.classList.add('copied');
          
          setTimeout(function() {
            button.textContent = 'Copy';
            button.classList.remove('copied');
          }, 2000);
        }).catch(function() {
          // Fallback for older browsers
          const textarea = document.createElement('textarea');
          textarea.value = code.textContent;
          document.body.appendChild(textarea);
          textarea.select();
          document.execCommand('copy');
          document.body.removeChild(textarea);
          
          button.textContent = 'Copied!';
          button.classList.add('copied');
          
          setTimeout(function() {
            button.textContent = 'Copy';
            button.classList.remove('copied');
          }, 2000);
        });
      }
    });
    
    block.appendChild(button);
  });

  // System preference dark mode
  const prefersDark = window.matchMedia('(prefers-color-scheme: dark)');
  
  function updateTheme(e) {
    // Add any dark mode specific adjustments here
    if (e.matches) {
      document.documentElement.setAttribute('data-theme', 'dark');
    } else {
      document.documentElement.setAttribute('data-theme', 'light');
    }
  }
  
  // Initial check
  updateTheme(prefersDark);
  
  // Listen for changes
  prefersDark.addListener(updateTheme);
});
</script>