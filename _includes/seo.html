<!-- Open Graph / Social Media Meta Tags -->
{% assign og_title = page.title | default: site.title %}
{% assign og_description = page.excerpt | default: page.description | default: site.description | strip_html | normalize_whitespace | truncate: 160 %}
{% assign og_url = page.url | absolute_url %}

<!-- Open Graph Image -->
{% if page.header.overlay_image %}
  {% assign og_image = page.header.overlay_image | absolute_url %}
{% elsif page.header.teaser %}
  {% assign og_image = page.header.teaser | absolute_url %}
{% elsif page.header.image %}
  {% assign og_image = page.header.image | absolute_url %}
{% elsif site.og_image %}
  {% assign og_image = site.og_image | absolute_url %}
{% else %}
  {% assign og_image = "/assets/images/social-preview.jpg" | absolute_url %}
{% endif %}

<!-- Open Graph -->
<meta property="og:type" content="{% if page.layout == 'post' %}article{% else %}website{% endif %}">
<meta property="og:title" content="{{ og_title }}">
<meta property="og:description" content="{{ og_description }}">
<meta property="og:url" content="{{ og_url }}">
<meta property="og:site_name" content="{{ site.title }}">
<meta property="og:image" content="{{ og_image }}">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">

<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@{{ site.twitter.username | default: 'xingchen1224' }}">
<meta name="twitter:creator" content="@{{ site.twitter.username | default: 'xingchen1224' }}">
<meta name="twitter:title" content="{{ og_title }}">
<meta name="twitter:description" content="{{ og_description }}">
<meta name="twitter:image" content="{{ og_image }}">

<!-- LinkedIn -->
<meta property="linkedin:owner" content="{{ site.social.linkedin }}">

<!-- Additional SEO -->
{% if page.layout == 'post' %}
  <meta property="article:author" content="{{ site.social.name | default: site.author.name }}">
  <meta property="article:published_time" content="{{ page.date | date_to_xmlschema }}">
  {% if page.last_modified_at %}
    <meta property="article:modified_time" content="{{ page.last_modified_at | date_to_xmlschema }}">
  {% endif %}
  {% for tag in page.tags %}
    <meta property="article:tag" content="{{ tag }}">
  {% endfor %}
{% endif %}

<!-- Canonical URL -->
<link rel="canonical" href="{{ og_url }}">

<!-- JSON-LD Structured Data -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Person",
  "name": "{{ site.author.name }}",
  "jobTitle": "Principal Developer",
  "description": "{{ site.description }}",
  "url": "{{ site.url }}",
  "sameAs": [
    "{{ site.author.links | where: 'label', 'GitHub' | map: 'url' | first }}",
    "{{ site.author.links | where: 'label', 'LinkedIn' | map: 'url' | first }}"
  ],
  "worksFor": {
    "@type": "Organization",
    "name": "Independent"
  },
  "knowsAbout": [
    "Software Engineering",
    "Web Development", 
    "System Architecture",
    "Team Leadership",
    "JavaScript",
    "TypeScript",
    "React",
    "Node.js"
  ]
}
</script>

{% if page.layout == 'post' %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "{{ page.title }}",
  "description": "{{ page.excerpt | strip_html | normalize_whitespace | truncate: 160 }}",
  "image": "{{ og_image }}",
  "author": {
    "@type": "Person",
    "name": "{{ site.author.name }}",
    "url": "{{ site.url }}"
  },
  "publisher": {
    "@type": "Person",
    "name": "{{ site.author.name }}",
    "logo": {
      "@type": "ImageObject",
      "url": "{{ site.author.avatar | absolute_url }}"
    }
  },
  "datePublished": "{{ page.date | date_to_xmlschema }}",
  {% if page.last_modified_at %}
  "dateModified": "{{ page.last_modified_at | date_to_xmlschema }}",
  {% endif %}
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "{{ og_url }}"
  }
}
</script>
{% endif %}

{% if page.collection == 'projects' %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "SoftwareApplication",
  "name": "{{ page.title }}",
  "description": "{{ page.excerpt | strip_html | normalize_whitespace }}",
  "url": "{{ page.demo_url | default: page.github_url }}",
  "author": {
    "@type": "Person",
    "name": "{{ site.author.name }}",
    "url": "{{ site.url }}"
  },
  "programmingLanguage": {{ page.technologies | jsonify }},
  "codeRepository": "{{ page.github_url }}",
  "applicationCategory": "Developer Tool"
}
</script>
{% endif %}